/* ************************************************************************** */
/* ********************** FILE DEFINITION SECTION *************************** */
/* ************************************************************************** */
/* File Name   : WDT_prg.c													  */
/* Author      : MAAM														  */
/* Version     : v01.2														  */
/* date        : Apr 8, 2023												  */
/* ************************************************************************** */
/* ************************ HEADER FILES INCLUDES **************************  */
/* ************************************************************************** */

#include "LBTY_int.h"
#include "LCTY_int.h"

#include "INTP.h"

#include "WDT_cfg.h"
#include "WDT_int.h"
#include "WDT_priv.h"

/* ************************************************************************** */
/* ********************** TYPE_DEF/STRUCT/ENUM SECTION ********************** */
/* ************************************************************************** */

/* ************************************************************************** */
/* ************************** MACRO/DEFINE SECTION ************************** */
/* ************************************************************************** */

/* ************************************************************************** */
/* ***************************** CONST SECTION ****************************** */
/* ************************************************************************** */

/* ************************************************************************** */
/* ***************************** VARIABLE SECTION *************************** */
/* ************************************************************************** */

/* ************************************************************************** */
/* **************************** FUNCTION SECTION **************************** */
/* ************************************************************************** */

/* ************************************************************************** */
/* Description :  	Initialization of the WDT								  */
/* Input       :	void													  */
/* Return      :	void													  */
/* ************************************************************************** */
void WDT_vidInit(void){
	S_WDTCR->sBits.m_WDE   = LBTY_SET;
	S_WDTCR->sBits.m_WDTOE = LBTY_RESET;
	S_WDTCR->sBits.m_WDP   = WDT_TIME_OUT;
}

/* ************************************************************************** */
/* Description :  	WDT Sleep												  */
/* Input       :	u8Period												  */
/* Return      :	void													  */
/* ************************************************************************** */
void WDT_vidSleep(u8 u8Period){
	S_WDTCR->sBits.m_WDP   = u8Period;
}

/* ************************************************************************** */
/* Description :  	WDT Reset												  */
/* Input       :	void													  */
/* Return      :	void													  */
/* ************************************************************************** */
void WDT_vidReset(void){
	wdr();	/* reset WDT */
//	while(!S_MCUCSR->sBits.m_WDRF);
//	S_MCUCSR->sBits.m_WDRF = LBTY_RESET;
	WDT_vidDisable();
	WDT_vidInit();
}

/* ************************************************************************** */
/* Description :  	WDT Enable												  */
/* Input       :	void													  */
/* Return      :	void													  */
/* ************************************************************************** */
void WDT_vidEnable(void){
	S_WDTCR->sBits.m_WDE = LBTY_SET;
}

/* ************************************************************************** */
/* Description :  	WDT Disable												  */
/* Input       :	void													  */
/* Return      :	void													  */
/* ************************************************************************** */
void WDT_vidDisable(void){
//	S_WDTCR->sBits.m_WDE   = LBTY_SET;
//	S_WDTCR->sBits.m_WDTOE = LBTY_SET;
	/* Write logical one to WDTOE and WDE */
	S_WDTCR->sOFF.m_OFF = 3u;
	/* Turn off WDT */
	S_WDTCR->u_Reg  = LBTY_RESET;
}

/*************************** E N D (WDT_prg.c) ******************************/
